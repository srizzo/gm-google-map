/*! gm-google-map - v0.0.1 - 2014-09-21
* https://github.com/srizzo/gm-google-map
* Copyright (c) 2014 Samuel Rizzo; Licensed MIT */
angular.module("gm-google-map",[]).directive("gmMapContext",function(){return{scope:!0,restrict:"EA",controller:["$scope",function(a){var b;a.setMap=function(a){b=a},a.getMap=function(){return b}}]}}).directive("gmMapCanvas",function(){return{scope:!0,restrict:"EA",require:"^?gmMapContext",link:{pre:function(a,b,c){var d=!1;c.gmDisableDefaultUi&&(d=a.$eval(c.gmDisableDefaultUi));var e=new google.maps.Map(b.get(0),{mapTypeId:google.maps.MapTypeId.ROADMAP,disableDefaultUI:d,styles:[{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]}]});a.setMap&&a.setMap(e),c.gmZoom&&a.$watch(c.gmZoom,function(a){e.setZoom(a)}),c.gmCenter&&a.$watch(c.gmCenter,function(a){null!=a&&e.setCenter(new google.maps.LatLng(a.lat,a.lng))}),a.safeApply=function(b){var c=a.$root.$$phase;"$apply"==c||"$digest"==c?b&&"function"==typeof b&&b():a.$apply(b)},angular.forEach(a.$eval(c.gmListeners),function(b,c){google.maps.event.addListener(e,c,function(){a.safeApply(function(){b()})})}),angular.forEach(a.$eval(c.gmListenersOnce),function(b,c){google.maps.event.addListenerOnce(e,c,function(){a.safeApply(function(){b()})})})}}}}).directive("gmAddOns",function(){return{scope:!0,restrict:"EA",compile:function(a){a.hide()}}}).directive("gmControl",function(){return{scope:!0,compile:function(a,b){return"undefined"==typeof b.gmVisible&&(b.gmVisible="true"),{pre:function(a,b,c){var d=b.get(0),e=a.getMap(),f=c.gmPosition||"LEFT_TOP";a.hide=function(){var a=e.controls[google.maps.ControlPosition[f]].indexOf(d);a>-1&&e.controls[google.maps.ControlPosition[f]].removeAt(a)},a.show=function(){var a=e.controls[google.maps.ControlPosition[f]].indexOf(d);0>a&&e.controls[google.maps.ControlPosition[f]].push(d)},a.$watch(c.gmVisible,function(b){b===!0?a.show():a.hide()})}}}}}).directive("gmInfoWindow",function(){return{scope:!0,compile:function(){return{pre:function(a,b,c){var d=b.get(0),e=new google.maps.InfoWindow;e.setContent(d),c.closeclick&&e.addListener("closeclick",function(){a.$apply(function(){a.$eval(c.closeclick)})}),a.openInfoWindow=function(){e.open(a.getMap(),a.getMarker())},a.closeInfoWindow=function(){e.close()}}}}}}).directive("gmOverlappingMarkerSpiderfier",function(){return{restrict:"AE",scope:!0,link:function(a,b){b.hide();var c=new OverlappingMarkerSpiderfier(a.getMap(),{keepSpiderfied:!0});a.getOverlappingMarkerSpiderfier=function(){return c},a.$on("gm_marker_created",function(a,b){c.addMarker(b)}),a.$on("gm_marker_destroyed",function(a,b){c.removeMarker(b)}),c.addListener("click",function(b,c){a.$apply(function(){google.maps.event.trigger(b,"gm_oms_click",c)})})}}}).directive("gmMarker",function(){return{restrict:"AE",scope:!0,compile:function(){return{pre:function(a,b,c){var d=new google.maps.Marker({map:a.getMap(),data:a.$eval(c.gmData),title:a.$eval(c.gmTitle),optimized:a.$eval(c.gmOptimized),position:new google.maps.LatLng(a.$eval(c.gmPosition).lat,a.$eval(c.gmPosition).lng)});a.getMarker=function(){return d};var e=a.$watch(c.gmIcon,function(a){d.setIcon(a)});a.$emit("gm_marker_created",d),a.$on("$destroy",function(){e(),d.setMap(null),a.$emit("gm_marker_destroyed",d)}),a.safeApply=function(b){var c=a.$root.$$phase;"$apply"==c||"$digest"==c?b&&"function"==typeof b&&b():a.$apply(b)},angular.forEach(a.$eval(c.gmListeners),function(b,c){google.maps.event.addListener(d,c,function(){a.safeApply(function(){b()})})}),angular.forEach(a.$eval(c.gmListenersOnce),function(b,c){google.maps.event.addListenerOnce(d,c,function(){a.safeApply(function(){b()})})})}}}}}).directive("gmAddListeners",function(){return{scope:!0,restrict:"EA",link:{pre:function(a,b,c){a.safeApply=function(b){var c=a.$root.$$phase;"$apply"==c||"$digest"==c?b&&"function"==typeof b&&b():a.$apply(b)},angular.forEach(a.$eval(c.gmListeners),function(b,d){a.$eval(c.gmTo).addListener(d,function(){a.safeApply(function(){b()})})}),angular.forEach(a.$eval(c.gmListenersOnce),function(b,d){a.$eval(c.gmTo).addListenerOnce(d,function(){a.safeApply(function(){b()})})})}}}});